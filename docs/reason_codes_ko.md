# Reason Codes & Messaging Guide

## 개요
이 문서는 DecisionOS에서 의사결정 결과에 대한 표준화된 사유 코드(Reason Codes)와 한국어 메시지를 정의합니다. 설명 가능성(Explainability)과 규제 준수를 위해 일관되고 명확한 사유 전달이 필수적입니다.

## 사유 코드 체계

### 코드 구조
```
{DOMAIN}-{CATEGORY}-{SUBCATEGORY}-{SEQUENCE}
```

- **DOMAIN**: 의사결정 도메인 (CREDIT, RISK, FRAUD, COMPLIANCE 등)
- **CATEGORY**: 주요 카테고리 (APPROVE, DENY, REVIEW, LIMIT 등)
- **SUBCATEGORY**: 세부 사유 (SCORE, INCOME, HISTORY 등)
- **SEQUENCE**: 순번 (001-999)

### 예시
- `CREDIT-DENY-SCORE-001`: 신용 승인 거부 - 신용점수 부족
- `RISK-REVIEW-INCOME-002`: 리스크 검토 필요 - 소득 검증 필요
- `FRAUD-DENY-PATTERN-001`: 사기 탐지 - 의심 패턴 발견

## 신용(CREDIT) 도메인 코드셋

### 승인 관련 (CREDIT-APPROVE-*)

#### CREDIT-APPROVE-STANDARD-001
**한글**: 신용 평가 결과 승인 기준을 충족하였습니다.
**설명**: 모든 신용 평가 항목이 최소 기준 이상
**조건**:
- 신용점수 ≥ 650
- 연체 이력 없음
- 소득 대비 부채 비율 < 40%

#### CREDIT-APPROVE-PREMIUM-001
**한글**: 우수한 신용 이력으로 프리미엄 조건이 적용되었습니다.
**설명**: 우대 고객 조건 충족
**조건**:
- 신용점수 ≥ 800
- 3년 이상 거래 이력
- 연체 이력 전무

#### CREDIT-APPROVE-CONDITIONAL-001
**한글**: 추가 조건부로 승인되었습니다. 담보 또는 보증인 제공이 필요합니다.
**설명**: 조건부 승인 (담보/보증 필요)
**조건**:
- 신용점수 600-649
- 담보 가치 ≥ 대출액 × 1.2

### 거부 관련 (CREDIT-DENY-*)

#### CREDIT-DENY-SCORE-001
**한글**: 신용점수가 최소 승인 기준에 미달하여 승인이 어렵습니다.
**설명**: 신용점수 부족
**기준**: 신용점수 < 600
**개선 방안**: "신용점수 향상을 위해 기존 대출의 성실한 상환과 신용카드 사용 관리가 필요합니다."

#### CREDIT-DENY-SCORE-002
**한글**: 신용 이력이 충분하지 않아 평가가 어렵습니다.
**설명**: 신용 이력 부족 (Thin File)
**기준**: 신용 거래 이력 < 6개월
**개선 방안**: "최소 6개월 이상의 신용 거래 이력이 필요합니다. 소액 신용카드 사용 후 재신청하시기 바랍니다."

#### CREDIT-DENY-DELINQUENCY-001
**한글**: 최근 연체 이력으로 인해 승인이 불가능합니다.
**설명**: 90일 이상 연체 이력 존재
**기준**: 최근 12개월 내 90일+ 연체 1건 이상
**개선 방안**: "연체 해소 후 최소 6개월 이상 정상 거래 이력 유지 후 재신청 가능합니다."

#### CREDIT-DENY-DELINQUENCY-002
**한글**: 현재 연체 중인 채무가 있어 신규 승인이 불가능합니다.
**설명**: 현재 연체 중
**기준**: 현재 30일 이상 연체 채무 존재
**개선 방안**: "연체 채무를 먼저 해소하신 후 재신청하시기 바랍니다."

#### CREDIT-DENY-DTI-001
**한글**: 소득 대비 부채 비율이 높아 추가 대출이 어렵습니다.
**설명**: DTI(Debt-to-Income) 비율 초과
**기준**: DTI ≥ 40%
**개선 방안**: "기존 대출 상환 또는 소득 증빙 금액 증가 후 재신청 가능합니다."

#### CREDIT-DENY-DTI-002
**한글**: 총부채원리금상환비율(DSR)이 규제 한도를 초과합니다.
**설명**: DSR(Debt Service Ratio) 한도 초과
**기준**: DSR ≥ 규제 한도 (예: 40%)
**개선 방안**: "부채 상환 또는 소득 증대를 통해 DSR을 낮추신 후 재신청하시기 바랍니다."

#### CREDIT-DENY-INCOME-001
**한글**: 소득 수준이 최소 신청 기준에 미달합니다.
**설명**: 최소 소득 기준 미달
**기준**: 연소득 < 제품별 최소 기준 (예: 2,400만원)
**개선 방안**: "소득 증빙이 가능한 추가 소득원 제출 시 재평가가 가능합니다."

#### CREDIT-DENY-INCOME-002
**한글**: 제출하신 소득 증빙 서류가 확인되지 않습니다.
**설명**: 소득 검증 실패
**기준**: 소득 증빙 미제출 또는 검증 불가
**개선 방안**: "공식 소득 증빙 서류(원천징수영수증, 소득금액증명원 등)를 제출하시기 바랍니다."

#### CREDIT-DENY-BANKRUPTCY-001
**한글**: 신용회복 또는 파산 이력으로 인해 현재 승인이 불가능합니다.
**설명**: 신용회복/파산 이력
**기준**: 최근 5년 내 개인회생/파산 이력
**개선 방안**: "신용회복 절차 완료 및 정상 신용 거래 이력 확보 후 재신청 가능합니다."

#### CREDIT-DENY-FRAUD-001
**한글**: 신청 정보에 이상 징후가 감지되어 승인이 보류되었습니다.
**설명**: 사기 의심 패턴 탐지
**기준**: Fraud score > 임계값
**개선 방안**: "고객센터로 연락하여 본인 확인 절차를 진행하시기 바랍니다."

#### CREDIT-DENY-POLICY-001
**한글**: 내부 정책상 현재 승인이 어렵습니다.
**설명**: 포트폴리오 관리 정책
**기준**: 업종/지역/상품별 익스포저 한도 초과
**개선 방안**: "추후 정책 변경 시 재신청 가능합니다. 고객센터로 문의하시기 바랍니다."

### 검토 필요 (CREDIT-REVIEW-*)

#### CREDIT-REVIEW-MANUAL-001
**한글**: 추가 검토가 필요하여 담당자가 확인 중입니다. 1-2 영업일 내 연락드리겠습니다.
**설명**: 수동 검토 필요 (경계선 케이스)
**조건**: 신용점수 590-610 (경계 구간)

#### CREDIT-REVIEW-INCOME-001
**한글**: 소득 증빙 확인이 필요합니다. 추가 서류를 요청드립니다.
**설명**: 소득 검증 필요
**필요 서류**:
- 원천징수영수증
- 재직증명서
- 급여 입금 내역 (최근 3개월)

#### CREDIT-REVIEW-INCOME-002
**한글**: 자영업자 소득 확인을 위해 추가 서류가 필요합니다.
**설명**: 자영업자 소득 검증
**필요 서류**:
- 사업자등록증
- 소득금액증명원 (최근 2년)
- 부가가치세 신고서

#### CREDIT-REVIEW-COLLATERAL-001
**한글**: 담보 가치 평가가 진행 중입니다.
**설명**: 담보 감정 필요
**소요 시간**: 3-5 영업일

#### CREDIT-REVIEW-GUARANTOR-001
**한글**: 보증인 신용 평가가 진행 중입니다.
**설명**: 연대보증인 심사 중
**소요 시간**: 1-2 영업일

### 한도 조정 (CREDIT-LIMIT-*)

#### CREDIT-LIMIT-REDUCE-001
**한글**: 신용 상태 변화로 인해 이용 한도가 조정되었습니다.
**설명**: 신용점수 하락으로 한도 감액
**조건**: 신용점수 50점 이상 하락

#### CREDIT-LIMIT-INCREASE-001
**한글**: 우수한 이용 이력으로 한도가 상향 조정되었습니다.
**설명**: 한도 증액 승인
**조건**:
- 12개월 이상 정상 이용
- 연체 이력 없음
- 신용점수 향상

## 리스크(RISK) 도메인 코드셋

### 고위험 거부 (RISK-DENY-*)

#### RISK-DENY-AML-001
**한글**: 자금세탁방지(AML) 정책에 따라 거래가 제한됩니다.
**설명**: AML 리스크 스코어 초과
**기준**: AML score > 80
**조치**: "고객센터를 통한 본인 확인 및 자금 출처 증빙이 필요합니다."

#### RISK-DENY-SANCTION-001
**한글**: 제재 대상 확인으로 인해 거래가 불가능합니다.
**설명**: 제재 리스트 매칭
**기준**: OFAC/UN 제재 리스트 일치
**조치**: "컴플라이언스팀 확인이 필요합니다."

#### RISK-DENY-PEP-001
**한글**: 정치적 주요 인물(PEP) 확인 절차가 필요합니다.
**설명**: PEP 스크리닝 적중
**조치**: "강화된 실사(EDD) 절차 진행이 필요합니다."

#### RISK-DENY-HIGHRISK-001
**한글**: 고위험 업종/국가로 분류되어 거래가 제한됩니다.
**설명**: 고위험 카테고리
**기준**:
- 고위험 업종 (카지노, 가상자산 등)
- 고위험 국가 (FATF 블랙리스트)

#### RISK-DENY-CONCENTRATION-001
**한글**: 포트폴리오 리스크 관리를 위해 현재 승인이 어렵습니다.
**설명**: 집중 리스크 한도 초과
**기준**: 단일 차주/업종/지역 익스포저 한도 초과

### 검토 필요 (RISK-REVIEW-*)

#### RISK-REVIEW-KYC-001
**한글**: 고객확인(KYC) 절차가 필요합니다.
**설명**: KYC 갱신 필요
**필요 정보**:
- 신분증 사본
- 주소 증빙
- 직업/소득 정보

#### RISK-REVIEW-TRANSACTION-001
**한글**: 거래 패턴 확인을 위해 추가 검토가 진행됩니다.
**설명**: 이상 거래 패턴 탐지
**소요 시간**: 1-3 영업일

#### RISK-REVIEW-AMOUNT-001
**한글**: 고액 거래로 인해 추가 승인 절차가 필요합니다.
**설명**: 고액 거래 임계값 초과
**기준**: 단일 거래 > 1억원

### 모니터링 (RISK-MONITOR-*)

#### RISK-MONITOR-WATCH-001
**한글**: 정기 모니터링 대상으로 지정되었습니다.
**설명**: 관심 대상 (Watchlist)
**조건**:
- 경미한 리스크 시그널
- 정기 검토 필요

## 사기(FRAUD) 도메인 코드셋

### 사기 거부 (FRAUD-DENY-*)

#### FRAUD-DENY-IDENTITY-001
**한글**: 신원 확인 과정에서 이상이 감지되어 거래가 차단되었습니다.
**설명**: 신원 도용 의심
**기준**: Identity verification score < 40
**조치**: "본인 확인을 위해 고객센터로 연락 바랍니다."

#### FRAUD-DENY-DEVICE-001
**한글**: 의심스러운 기기에서의 접근으로 거래가 차단되었습니다.
**설명**: 고위험 디바이스 탐지
**기준**: Device fingerprint 블랙리스트 매칭
**조치**: "등록된 기기에서 재시도하거나 본인 인증을 진행하시기 바랍니다."

#### FRAUD-DENY-VELOCITY-001
**한글**: 비정상적인 거래 빈도가 감지되어 일시적으로 차단되었습니다.
**설명**: Velocity 규칙 위반
**기준**:
- 1시간 내 5회 이상 거래 시도
- 1일 내 20회 이상 거래
**조치**: "24시간 후 재시도하시거나 고객센터로 문의하시기 바랍니다."

#### FRAUD-DENY-PATTERN-001
**한글**: 의심스러운 거래 패턴이 탐지되었습니다.
**설명**: 사기 패턴 매칭
**기준**: Fraud ML model score > 0.85
**조치**: "보안 확인을 위해 고객센터 연락이 필요합니다."

#### FRAUD-DENY-LOCATION-001
**한글**: 비정상적인 위치에서의 접근으로 거래가 차단되었습니다.
**설명**: 위치 이상 탐지
**기준**:
- 불가능한 여행 (30분 내 1000km 이동)
- 고위험 국가 접속
**조치**: "본인 인증 후 거래가 가능합니다."

### 사기 검토 (FRAUD-REVIEW-*)

#### FRAUD-REVIEW-SUSPICIOUS-001
**한글**: 의심 거래로 분류되어 확인 중입니다.
**설명**: 중간 위험도 사기 스코어
**기준**: Fraud score 0.6-0.85
**소요 시간**: 1-4시간

#### FRAUD-REVIEW-FIRSTTIME-001
**한글**: 신규 거래 패턴으로 보안 확인이 진행됩니다.
**설명**: 첫 거래 또는 신규 패턴
**소요 시간**: 10-30분

## 컴플라이언스(COMPLIANCE) 도메인 코드셋

### 규제 거부 (COMPLIANCE-DENY-*)

#### COMPLIANCE-DENY-AGE-001
**한글**: 연령 제한으로 인해 서비스 이용이 불가능합니다.
**설명**: 최소 연령 미달
**기준**: 만 19세 미만
**개선 방안**: "만 19세 이상부터 이용 가능합니다."

#### COMPLIANCE-DENY-JURISDICTION-001
**한글**: 해당 지역에서는 서비스를 제공하지 않습니다.
**설명**: 서비스 제공 불가 지역
**기준**: 라이센스 미보유 국가/지역

#### COMPLIANCE-DENY-LICENSE-001
**한글**: 필수 자격 요건을 충족하지 못했습니다.
**설명**: 필요 라이센스/자격 미보유
**개선 방안**: "필수 자격증 취득 후 재신청 가능합니다."

### 규제 검토 (COMPLIANCE-REVIEW-*)

#### COMPLIANCE-REVIEW-DOCUMENT-001
**한글**: 필수 서류 확인이 필요합니다.
**설명**: 규제 서류 검토
**필요 서류**: [상황별 명시]

#### COMPLIANCE-REVIEW-CONSENT-001
**한글**: 추가 동의가 필요합니다.
**설명**: 법적 동의 누락
**필요 동의**:
- 개인정보 제3자 제공 동의
- 신용정보 조회 동의

## 메시징 가이드라인

### 메시지 작성 원칙

1. **명확성 (Clarity)**
   - 전문 용어 최소화
   - 구체적인 사유 명시
   - 이해하기 쉬운 언어 사용

2. **투명성 (Transparency)**
   - 결정 근거 설명
   - 사용된 데이터/기준 명시
   - 주요 영향 요인 공개

3. **실행 가능성 (Actionability)**
   - 개선 방안 제시
   - 다음 단계 안내
   - 연락처/지원 정보 제공

4. **공감 (Empathy)**
   - 존중하는 어조 유지
   - 부정적 결과에 대한 배려
   - 긍정적 대안 제시

5. **규제 준수 (Compliance)**
   - 법적 요구사항 충족
   - 차별적 표현 금지
   - FCRA/ECOA 등 규제 준수

### 메시지 템플릿 구조

```markdown
## 결정 결과
{승인/거부/검토}

## 주요 사유
{reason_code 메시지}

## 세부 설명
{추가 컨텍스트, 사용된 기준}

## 영향 요인
- {Factor 1}: {설명}
- {Factor 2}: {설명}
- {Factor 3}: {설명}

## 개선 방안
{실행 가능한 다음 단계}

## 문의하기
{연락처 정보}
```

### 톤앤매너 예시

❌ **나쁜 예시**:
```
거부됨. 신용점수 부족. 재신청 불가.
```

✅ **좋은 예시**:
```
검토해 주셔서 감사합니다. 현재 신용점수가 최소 승인 기준인 600점에
미달(현재 580점)하여 승인이 어렵습니다.

신용점수 향상을 위해 다음을 권장드립니다:
- 기존 대출의 성실한 상환
- 신용카드 한도 대비 사용률 30% 이하 유지
- 6개월 후 재신청 (예상 점수 향상 시)

추가 문의: 1588-XXXX (평일 9-18시)
```

## 다국어 지원 (향후)

현재는 한국어(ko) 중심이나, 향후 확장 시:
- `reason_codes_en.md`: 영어
- `reason_codes_ja.md`: 일본어
- `reason_codes_zh.md`: 중국어

각 언어별 문화적 맥락과 규제 요구사항을 반영하여 작성.

## API 통합 예시

### Reason Code 조회
```python
from decisionos import ReasonCodeRegistry

registry = ReasonCodeRegistry(locale='ko')

# 코드로 조회
code = registry.get('CREDIT-DENY-SCORE-001')
print(code.message)  # "신용점수가 최소 승인 기준에 미달하여..."
print(code.improvement_advice)  # "신용점수 향상을 위해..."

# 결정에 자동 첨부
decision = {
    'outcome': 'DENY',
    'reason_codes': ['CREDIT-DENY-SCORE-001', 'CREDIT-DENY-DTI-001'],
    'factors': [
        {'name': 'credit_score', 'value': 580, 'weight': 0.4},
        {'name': 'dti_ratio', 'value': 0.45, 'weight': 0.3}
    ]
}

explanation = registry.generate_explanation(decision)
```

### 출력 예시
```json
{
  "decision_id": "dec_20250103_abc123",
  "outcome": "DENY",
  "reason_codes": [
    {
      "code": "CREDIT-DENY-SCORE-001",
      "message": "신용점수가 최소 승인 기준에 미달하여 승인이 어렵습니다.",
      "category": "PRIMARY",
      "improvement_advice": "신용점수 향상을 위해 기존 대출의 성실한 상환과 신용카드 사용 관리가 필요합니다."
    },
    {
      "code": "CREDIT-DENY-DTI-001",
      "message": "소득 대비 부채 비율이 높아 추가 대출이 어렵습니다.",
      "category": "CONTRIBUTING",
      "improvement_advice": "기존 대출 상환 또는 소득 증빙 금액 증가 후 재신청 가능합니다."
    }
  ],
  "factors": [
    {
      "name": "신용점수",
      "value": "580점",
      "impact": "높음",
      "direction": "부정적"
    },
    {
      "name": "소득 대비 부채 비율",
      "value": "45%",
      "impact": "중간",
      "direction": "부정적"
    }
  ]
}
```

## 코드 관리 및 거버넌스

### 코드 추가 프로세스
1. **요청**: 제품팀/컴플라이언스팀이 신규 코드 필요성 제기
2. **검토**: 법무/컴플라이언스 검토
3. **승인**: Reason Code Committee 승인
4. **구현**: 코드 및 메시지 추가
5. **배포**: 버전 관리 및 배포

### 버전 관리
```yaml
# reason_codes_version.yaml
version: 2.1.0
last_updated: 2025-11-03
changes:
  - version: 2.1.0
    date: 2025-11-03
    changes:
      - added: CREDIT-DENY-DSR-002
      - updated: CREDIT-DENY-SCORE-001 (메시지 개선)
      - deprecated: CREDIT-DENY-OLD-001
```

### 주기적 검토
- **월간**: 사용 빈도 분석, 고객 피드백 수집
- **분기**: 메시지 효과성 평가, 개선 사항 도출
- **연간**: 전체 코드셋 감사, 규제 변경 반영

## 참고 자료

- [Fair Credit Reporting Act (FCRA)](https://www.ftc.gov/legal-library/browse/statutes/fair-credit-reporting-act)
- [Equal Credit Opportunity Act (ECOA)](https://www.consumerfinance.gov/rules-policy/regulations/1002/)
- 신용정보의 이용 및 보호에 관한 법률
- 여신전문금융업법

## 관련 문서
- [Decision Explainability Guide](explainability_guide.md)
- [Model Card Template](model_card_template.yaml)
- [Evidence Export Template](../templates/explain_export.md)
